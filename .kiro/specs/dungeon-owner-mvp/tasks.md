# 実装計画

## 概要

ダンジョンオーナーMVPの実装を段階的に進めるためのタスク分解です。各タスクは1-2日の粒度で設計され、テスト駆動開発を重視し、段階的な機能構築を行います。

## タスク一覧

- [x] 1. プロジェクト基盤とコアシステムの構築
  - Unity 2Dプロジェクトの初期設定とフォルダ構造の作成
  - GameManagerとTimeManagerの基本実装
  - ScriptableObjectベースのデータ駆動アーキテクチャの構築
  - _要件: 1.1, 8.1, 14.1_

- [x] 2. 基本データモデルとScriptableObjectの実装
  - MonsterData、InvaderData、PlayerCharacterDataのScriptableObject作成
  - 初期モンスター（スライム、スケルトン等）のデータ定義
  - 基本侵入者（戦士、魔法使い等）のデータ定義
  - _要件: 3.2, 17.1, 17.2_

- [x] 3. 階層システムの基本実装
  - FloorSystemとFloorクラスの実装
  - 初期3階層の生成と上下階段の配置
  - 階層間の基本的な移動システム
  - _要件: 10.1, 10.2, 8.2_

- [x] 4. モンスター配置システムの実装
  - IMonsterインターフェースと基本モンスタークラスの実装
  - モンスター配置・除去機能の実装
  - 階層あたり15体制限の実装
  - _要件: 3.1, 3.3, 3.4_

- [x] 5. 初期モンスター配置とゲーム開始状態の実装
  - 1階層への自キャラクター+14体モンスターの初期配置
  - 具体的なモンスター構成（スライム5、スケルトン3等）の実装
  - ゲーム開始時の状態初期化
  - _要件: 3.1, 3.2, 8.2_

- [x] 6. 侵入者システムの基本実装
  - IInvaderインターフェースと基本侵入者クラスの実装
  - 侵入者の1階層上り階段からの出現システム
  - 基本的な移動とアニメーション
  - _要件: 1.3, 18.1, 18.5_

- [x] 7. リアルタイム戦闘システムの実装
  - モンスターと侵入者の衝突判定システム
  - 確率ベースのダメージ計算と吹き飛ばし効果
  - 基本的な戦闘アニメーションとエフェクト
  - _要件: 1.4, 2.1, 2.2, 2.3_

- [x] 8. レベルシステムと戦闘計算の実装
  - モンスターと侵入者のレベル表示システム
  - レベル差を考慮した戦闘計算式
  - 階層深度に応じた侵入者レベル上昇
  - _要件: 17.1, 17.2, 17.3, 17.4_

- [x] 9. 経済システムの実装
  - ResourceManagerによる金貨管理システム
  - 侵入者撃破時の金貨報酬システム
  - 1日経過による自動金貨付与システム
  - _要件: 12.1, 12.2, 12.5_

- [x] 10. モンスターアビリティシステムの実装
  - MonsterAbilityの基底クラスとインターフェース
  - スライムの自動体力回復アビリティ
  - スケルトン・ゴーストの自動復活アビリティ
  - _要件: 4.1, 4.2, 4.4, 4.5_

- [x] 11. HP/MP回復システムの実装
  - 階層配置中の緩やかな回復システム
  - 退避スポットでの高速回復システム
  - 回復状況の視覚的表示
  - _要件: 9.1, 9.2, 9.5_

- [x] 12. 退避スポットシステムの実装
  - ShelterManagerとモンスター移動システム
  - 退避スポットでのモンスター管理UI
  - 階層からの退避と再配置機能
  - _要件: 7.1, 7.2, 7.3, 7.4_

- [x] 13. モンスター売却システムの実装
  - 退避スポット内モンスターの売却機能
  - 購入価格の一定割合での金貨返還
  - 売却確認UIと安全機能
  - _要件: 5.1, 5.2, 5.3, 5.4_

- [x] 14. 自キャラクターシステムの実装
  - PlayerCharacterクラスと選択システム
  - 撃破時の退避スポット蘇生機能
  - レベル引き継ぎシステム
  - _要件: 8.1, 8.2, 8.3, 8.4_

- [x] 15. 階層拡張システムの実装
  - 階層数に応じたコスト増加システム
  - 新階層生成と階段配置
  - 拡張時の新モンスター解放機能
  - _要件: 10.4, 10.5, 12.4_

- [x] 16. 侵入者ランダム出現システムの実装
  - ランダムタイミングでの侵入者生成
  - 連続出現防止機能
  - 階層深度に応じた出現頻度調整
  - _要件: 18.1, 18.2, 18.3, 18.4_

- [x] 17. パーティシステムの基本実装
  - IPartyインターフェースとPartyManagerの実装
  - パーティメンバーの同期移動システム
  - パーティ内でのダメージ分散機能
  - _要件: 19.1, 19.2, 19.5_

- [x] 18. パーティ戦闘システムの実装
  - パーティ間の協力戦闘システム
  - 回復スキルのパーティ内適用
  - 侵入者パーティの出現システム
  - _要件: 19.3, 19.4, 18.3_

- [x] 19. ボスキャラシステムの実装
  - 5階層ごとのボスキャラ配置システム
  - ボスキャラの選択式配置UI
  - 撃破後の再リポップとレベル引き継ぎ
  - _要件: 6.1, 6.2, 6.4, 6.5_

- [x] 20. 罠アイテムシステムの実装
  - TrapItemDataとインベントリシステム
  - 侵入者撃破時の低確率ドロップ
  - 罠アイテム使用と視覚エフェクト
  - _要件: 13.1, 13.2, 13.3, 13.4_

- [x] 21. 時間制御システムの実装
  - ゲーム速度切り替え（1x/1.5x/2x）機能
  - 全ゲーム要素への速度適用システム
  - 速度表示UIとコントロール
  - _要件: 14.1, 14.2, 14.5_

- [x] 22. 階層改装システムの実装
  - 空階層での改装モード有効化
  - 階段経路確保の制約システム
  - 改装UIとレイアウト保存機能
  - _要件: 11.1, 11.2, 11.3, 11.4_

- [x] 23. ユーザーインターフェースの実装
  - 縦画面レイアウトと片手操作UI
  - モンスター配置時のゴースト表示
  - リアルタイム戦闘の視覚的表示
  - _要件: 15.1, 15.2, 15.3, 15.4_

- [ ] 24. データ永続化システムの実装
  - SaveManagerとセーブデータ構造の実装
  - 自動保存機能（撃破時、終了時）
  - セーブデータ復元とエラーハンドリング
  - _要件: 16.1, 16.2, 16.3, 16.5_

- [ ] 25. チュートリアルシステムの実装
  - 初回起動時のチュートリアルモード
  - 段階的な操作説明とガイド
  - スキップ機能と通常モード移行
  - _要件: 20.1, 20.2, 20.3, 20.4_

- [ ] 26. パフォーマンス最適化とポリッシュ
  - オブジェクトプールの実装
  - 60FPS維持のための最適化
  - メモリ使用量の最適化
  - _要件: 1.5, 14.3, 14.4_

- [ ] 27. 統合テストとバランス調整
  - 全システムの統合テスト実行
  - ゲームバランスの調整とパラメータ最適化
  - iOS・Android実機での動作確認
  - _要件: 全要件の統合確認_

- [ ] 28. 最終ポリッシュとリリース準備
  - UI/UXの最終調整
  - バグ修正と安定性向上
  - ビルド設定とリリース準備
  - _要件: 全要件の最終確認_